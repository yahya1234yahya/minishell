close in fd;
safe malloc instead of malloc;
